#!/bin/sh
# Pre-commit hook para Alberto RodrÃ­guez Couture
# Verifica TypeScript y build antes de cada commit

echo "ğŸ” Verificando TypeScript..."

# Verificar tipos TypeScript
if ! npm run check; then
    echo "âŒ Error de TypeScript detectado. Fix los errores antes de commit."
    exit 1
fi

echo "âœ… TypeScript OK"

# Verificar que el build funcione
echo "ğŸ”¨ Verificando build..."
if ! npm run build > /dev/null 2>&1; then
    echo "âŒ Error de build detectado. Fix los errores antes de commit."
    exit 1
fi

echo "âœ… Build OK"

# Verificar archivos .env no se incluyan
if git diff --cached --name-only | grep -E "^\.env$|^\.env\.local$|^\.env\.production$"; then
    echo "âŒ Archivos .env detectados en staging. Remove antes de commit:"
    git diff --cached --name-only | grep -E "^\.env"
    exit 1
fi

echo "âœ… Seguridad OK"
echo "ğŸš€ Commit aprobado!"

exit 0